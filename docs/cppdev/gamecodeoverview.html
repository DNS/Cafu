
<h1 class="sectionedit1" id="game_development_overview">Game Development Overview</h1>
<div class="level1">



<p>
The Cafu Engine can be used both for developing single- or multiplayer games that ship as individual products,
as well as for products that support multiple, independent games in a single program that the user can select from at runtime.
</p>

<p>
For example, after starting the program, the user might choose from a list of online game servers
(each possibly running not only different game maps, but entirely different games),
or a list of available single-player games, and join one seamlessly without restarting the program.
</p>

<p>
The fact the multiple games can be present at the same time makes it worthwhile to keep all related files and program code well organized, so that games can be developed and shipped to end users modularly and independently of each other and of the Cafu core engine.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Game Development Overview&quot;,&quot;hid&quot;:&quot;game_development_overview&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-1215&quot;} -->
<h2 class="sectionedit2" id="one_directory_per_game">One directory per game</h2>
<div class="level2">

<p>
In order to achieve these goals, all files, data and program code for a game are stored in one common directory, which in turn must be a subdirectory of <code>Games/</code>.
</p>

<p>
For an example, see the <code>Games/DeathMatch/</code> directory of the DeathMatch example game that ships with Cafu:
</p>

<p>
<a href="/_detail/cppdev:deathmatchdirectory.png?id=cppdev%3Agamecodeoverview" class="media" title="cppdev:deathmatchdirectory.png"><img src="/_media/cppdev:deathmatchdirectory.png" class="media" alt="" /></a>
</p>

<p>
(Also see <a href="/cppdev:startnewgame" class="wikilink1" title="cppdev:startnewgame">Starting your own Game</a> for help about creating a new game directory.)
</p>

<p>
Although you&#039;re largely free to organize the contents of the game directory as desired,
per convention some of the resource files must be kept under fixed names or in given directories,
so that the Cafu Engine can find and load them when it is newly initializing the game.
</p>

<p>
The following sub-sections list and explain most of these “fixed” files and directories.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;One directory per game&quot;,&quot;hid&quot;:&quot;one_directory_per_game&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;1216-2012&quot;} -->
<h3 class="sectionedit3" id="guis">GUIs/</h3>
<div class="level3">

<p>
The graphical user interfaces that are used in a game are kept in <code>GUIs/</code>.
</p>

<p>
GUIs are used both
</p>
<ul>
<li class="level1"><div class="li"> in “2D”, e.g. for the main menu, the console window, the “HUD” (head-up display) in the game, etc., as well as</div>
</li>
<li class="level1"><div class="li"> in “3D”, as parts of the game worlds, that the player can use e.g. to call lifts, to unlock doors, to activate teleporters, or to control any other game script action.</div>
</li>
</ul>

<p>
The GUIs kept in <code>GUIs/</code> are usually “2D” GUIs, and “3D” GUIs that are universally used in multiple maps. “3D” GUIs that are specific to a single map can either be stored in <code>GUIs/</code> as well, or along with the map in the same directory as the map.
</p>

<p>
At this time, the following GUIs are automatically loaded by the Cafu Engine:
</p>
<ul>
<li class="level1"><div class="li"> <code>GUIs/ChatInput.cgui</code> – implements the text input when the player presses <code>T</code> to talk in the game.</div>
</li>
<li class="level1"><div class="li"> <code>GUIs/Console.cgui</code> – implements the in-game command console, opened with <code>F1</code>.</div>
</li>
<li class="level1"><div class="li"> <code>GUIs/MainMenu/MainMenu_main.cgui</code> – implements the main menu that is shown after program start.</div>
</li>
</ul>

<p>
In addition, the DeathMatch game code in <code>DeathMatch/Code/HumanPlayer.cpp</code> loads
</p>
<ul>
<li class="level1"><div class="li"> <code>GUIs/HUD_main.cgui</code> – implements the players head-up display (cross-hair, ammo count, etc.).</div>
</li>
</ul>

<p>
You can replace all these GUIs by providing your own editions in their place, or just copy them from the DeathMatch example game and modify them as you like.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;GUIs\/&quot;,&quot;hid&quot;:&quot;guis&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;2013-3392&quot;} -->
<h3 class="sectionedit4" id="maps">Maps/</h3>
<div class="level3">

<p>
Contains the map files as saved by the <abbr title="Cafu World Editor">CaWE</abbr> Map Editor.
</p>

<p>
You don&#039;t actually have to save your map files in this directory, but we may merge <code>Maps/</code> and <code>Worlds/</code> sometime in the future, and thus <code>Maps/</code> is still the recommended place to save <code>.<abbr title="Cafu Map File. Create them with CaWE, turn them into cw files with CaBSP.">cmap</abbr></code> files.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Maps\/&quot;,&quot;hid&quot;:&quot;maps&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;3393-3676&quot;} -->
<h3 class="sectionedit5" id="materials">Materials/</h3>
<div class="level3">

<p>
All material definitions for the game maps are kept in <code>Materials/</code>.
Materials are often reused in several maps of a game, and thus <code>Materials/</code> is where all map materials are centrally stored.
</p>

<p>
The <abbr title="Cafu World Editor">CaWE</abbr> Map Editor loads the material definitions from this folder in order to provide the map designer with the choices in the Material Browser dialog. The Cafu Engine loads the material definitions from <code>Materials/</code> as well in order to render the materials in the game.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Materials\/&quot;,&quot;hid&quot;:&quot;materials&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;3677-4174&quot;} -->
<h3 class="sectionedit6" id="music_nexttitletxt">Music/NextTitle.txt</h3>
<div class="level3">

<p>
Whenever the player enters a new map, the client calls console function <code>StartLevelIntroMusic()</code>, that in turn is defined in file <code>config.lua</code> in the Cafu top level directory and that uses file <code>Music/NextTitle.txt</code> in order to play the next title from the list of files in <code>Music/</code>.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Music\/NextTitle.txt&quot;,&quot;hid&quot;:&quot;music_nexttitletxt&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;4175-4499&quot;} -->
<h3 class="sectionedit7" id="textures">Textures/</h3>
<div class="level3">

<p>
The texture images that the materials in <code>Materials/</code> are referring to are stored here.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Textures\/&quot;,&quot;hid&quot;:&quot;textures&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;4500-4612&quot;} -->
<h3 class="sectionedit8" id="worlds">Worlds/</h3>
<div class="level3">

<p>
Maps from <code>Maps/</code> must be “compiled” in order to be used with the Cafu Engine.
Compiling turns a map file (suffix <code>.<abbr title="Cafu Map File. Create them with CaWE, turn them into cw files with CaBSP.">cmap</abbr></code>) into a world file (suffix <code>.<abbr title="Cafu world file. A cw file is created from a cmap file with CaBSP.">cw</abbr></code>) and is documented at <a href="/mapping:compiling_new" class="wikilink1" title="mapping:compiling_new">Compiling Maps for Cafu</a>.
</p>

<p>
The world files generated by compiling are stored in <code>Worlds/</code>, where the main menu <abbr title="Graphical User Interface">GUI</abbr> (<code>MainMenu_main.cgui</code> in the DeathMatch example game) looks for <code>.<abbr title="Cafu world file. A cw file is created from a cmap file with CaBSP.">cw</abbr></code> files that the player can choose to enter.
It also looks for a matching screenshot image to show with the maps list.
</p>

<p>
The <code>Worlds/</code> directory is also the right place for <a href="http://api.cafu.de/lua/" class="urlextern" title="http://api.cafu.de/lua/" rel="nofollow">map scripts</a>:
</p>
<ul>
<li class="level1"><div class="li"> A map scripts must be placed into the <code>Worlds/</code> directory “next” to the compiled world file. That is, the script must have the same base name as the world, but suffix <code>.lua</code> instead of <code>.<abbr title="Cafu world file. A cw file is created from a cmap file with CaBSP.">cw</abbr></code>.</div>
</li>
<li class="level1"><div class="li"> The map script is <em>not</em> compiled along with the <code>.<abbr title="Cafu world file. A cw file is created from a cmap file with CaBSP.">cw</abbr></code> file: You can change it at any time, and the changes become effective as soon as the world is loaded/restarted the next time. In fact, it is even possible to <a href="/general:developer_faq#how_do_i_dynamically_reload_the_map_script_in-game" class="wikilink1" title="general:developer_faq">update a map script while the game is running</a>, that is, <em>without interrupting it</em>.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Worlds\/&quot;,&quot;hid&quot;:&quot;worlds&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;4613-5806&quot;} -->
<h2 class="sectionedit9" id="exploring_the_code">Exploring the code</h2>
<div class="level2">

<p>
The class hierarchy is shown in <code>Ca3DE/ClassDiagram.dia</code>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Exploring the code&quot;,&quot;hid&quot;:&quot;exploring_the_code&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;5807-&quot;} -->